# Better structure - focused on what developers need
version: "1.0"
id: "deployment_failed"
name: "Deployment Failure Alert"
description: "Notify IT Operations when a deployment fails"
category: "hr-it-operations"
tags: ["deployment", "failure", "alert", "it-ops"]

channels:
  email:
    subject: "ðŸš¨ Deployment {{deployment_id}} Failed at {{failure_stage}}"
    body: |
      Hi Team,
      
      The recent deployment has encountered an issue.
      
      â€¢ Deployment ID: {{deployment_id}}  
      â€¢ Failure Stage: {{failure_stage}}  
      â€¢ Error Details: {{error_details}}  
      â€¢ Rollback Status: {{rollback_status}}  
      â€¢ Incident Ticket: {{incident_ticket}}  

      Please investigate and take corrective action.
      
      â€” SIREN Notification System

  slack:
    text: |
      ðŸš¨ *Deployment {{deployment_id}} failed at {{failure_stage}}*
      â€£ Error: {{error_details}}
      â€£ Rollback: {{rollback_status}}
      â€£ Ticket: {{incident_ticket}}

  teams:
    text: |
      **Deployment Failure Alert**
      â€¢ **ID**: {{deployment_id}}  
      â€¢ **Stage**: {{failure_stage}}  
      â€¢ **Error**: {{error_details}}  
      â€¢ **Rollback**: {{rollback_status}}  
      â€¢ **Ticket**: {{incident_ticket}}

  sms:
    text: "ALERT: Deployment {{deployment_id}} failed at {{failure_stage}}. Ticket: {{incident_ticket}}. Check email for details."

  whatsapp:
    text: |
      ðŸš¨ *Deployment Failed*
      â€¢ *ID:* {{deployment_id}}
      â€¢ *Stage:* {{failure_stage}}
      â€¢ *Error:* {{error_details}}
      â€¢ *Rollback:* {{rollback_status}}
      â€¢ *Ticket:* {{incident_ticket}}

      Please review immediately.

  push:
    title: "Deployment {{deployment_id}} Failure"
    body: "Failed at {{failure_stage}} (Ticket: {{incident_ticket}})."

variables:
  required: ["deployment_id", "failure_stage", "error_details", "rollback_status", "incident_ticket"]
  optional: []

# THIS is what matters - show them how to use it
examples:
  - description: "Basic usage"
    data:
      deployment_id: "DEP-20250623-01"
      failure_stage: "Database Migration"
      error_details: "Timeout connecting to replica set"
      rollback_status: "Completed"
      incident_ticket: "INC-7890"
