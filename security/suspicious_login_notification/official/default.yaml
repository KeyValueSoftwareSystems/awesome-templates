# Better structure - focused on what developers need
version: "1.0"
id: "suspicious_login_notification"
name: "Suspicious Login Attempt Notification"
description: "Alert user when a potentially fraudulent login is detected"
category: "security"
tags: ["security", "login", "alert", "notification"]

channels:
  email:
    subject: "üîí Suspicious Login Attempt Detected for {{user_email}}"
    body: |
      Hi there,

      We detected a suspicious login attempt on your account:

        ‚Ä¢ User:       {{user_email}}
        ‚Ä¢ Time:       {{timestamp}}
        ‚Ä¢ Location:   {{login_location}}
        ‚Ä¢ Device:     {{device_info}}
        ‚Ä¢ IP address: {{ip_address}}
        ‚Ä¢ Risk score: {{risk_score}}

      If this was you, please verify your activity here:
      {{verification_link}}

      If you did not attempt to log in, please secure your account immediately.

      ‚Äî The Security Team
  slack:
    text: "‚ö†Ô∏è Suspicious login for {{user_email}} from {{login_location}} (Risk: {{risk_score}}). Verify: {{verification_link}}"
  teams:
    text: "‚ö†Ô∏è Suspicious login detected for **{{user_email}}**\n‚Ä¢ Location: {{login_location}}\n‚Ä¢ Device: {{device_info}}\n‚Ä¢ Risk: {{risk_score}}\n[Verify now]({{verification_link}})"
  sms:
    text: "Suspicious login for {{user_email}} on {{timestamp}}. Verify: {{verification_link}}"
  whatsapp:
    text: |
      *Suspicious Login Alert*

      ‚Ä¢ *User:* {{user_email}}
      ‚Ä¢ *When:* {{timestamp}}
      ‚Ä¢ *Where:* {{login_location}} (IP: {{ip_address}})
      ‚Ä¢ *Device:* {{device_info}}
      ‚Ä¢ *Risk:* {{risk_score}}

      Verify here üëâ {{verification_link}}

      If this wasn‚Äôt you, please secure your account immediately.
  push:
    title: "‚ö†Ô∏è Suspicious Login Detected"
    body: "Risk {{risk_score}} for {{user_email}}. Tap to verify."

variables:
  required:
    - user_email
    - login_location
    - device_info
    - timestamp
    - ip_address
    - risk_score
    - verification_link
  optional: []

# THIS is what matters - show them how to use it
examples:
  - description: "Basic usage"
    data:
      user_email: "alex@example.com"
      login_location: "New York, NY"
      device_info: "Chrome on macOS"
      timestamp: "2025-06-23 14:45:00"
      ip_address: "203.0.113.42"
      risk_score: "85"
      verification_link: "https://app.example.com/verify-login?token=abc123"
